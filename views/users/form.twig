{% extends "layout.twig" %}
{% block title %}{{ user ? 'Editar usuário' : 'Novo usuário' }}{% endblock %}
{% block page_title %}{{ user ? 'Editar usuário' : 'Novo usuário' }}{% endblock %}
{% block content %}
<form method="post" action="{{ user ? '/users/' ~ user.id : '/users' }}">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
    <div class="form-group">
        <label for="name">Nome</label>
        <input type="text" class="form-control {{ errors.name is defined ? 'is-invalid' : '' }}" id="name" name="name" value="{{ user.name|default('') }}" required>
        {% if errors.name is defined %}<div class="invalid-feedback">{{ errors.name }}</div>{% endif %}
    </div>
    <div class="form-group">
        <label for="email">Email</label>
        <input type="email" class="form-control {{ errors.email is defined ? 'is-invalid' : '' }}" id="email" name="email" value="{{ user.email|default('') }}" required>
        {% if errors.email is defined %}<div class="invalid-feedback">{{ errors.email }}</div>{% endif %}
    </div>
    <div class="form-group">
        <label for="password">Senha {% if user %} (deixe em branco para manter){% endif %}</label>
        <input type="password" class="form-control {{ errors.password is defined ? 'is-invalid' : '' }}" id="password" name="password" {{ user ? '' : 'required' }}>
        {% if errors.password is defined %}<div class="invalid-feedback">{{ errors.password }}</div>{% endif %}
    </div>
    <div class="form-group">
        <label for="status">Status</label>
        <select class="form-control" id="status" name="status">
            <option value="active" {{ (user.status|default('')) == 'active' ? 'selected' : '' }}>Ativo</option>
            <option value="inactive" {{ (user.status|default('')) == 'inactive' ? 'selected' : '' }}>Inativo</option>
        </select>
    </div>
    <div class="form-group">
        <label>Papéis</label>
        {% for role in roles %}
        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="role_ids[]" value="{{ role.id }}" id="role_{{ role.id }}"
                {{ (user.role_ids is defined and role.id in user.role_ids) ? 'checked' : '' }}>
            <label class="form-check-label" for="role_{{ role.id }}">{{ role.name }}</label>
        </div>
        {% endfor %}
    </div>
    <button type="submit" class="btn btn-primary">Salvar</button>
    <a href="/users" class="btn btn-secondary">Cancelar</a>
</form>
{% endblock %}
